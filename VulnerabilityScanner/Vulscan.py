# Script created by Chiriac Adrian Stefan (chr.adrian@yahoo.com)
# Brief : script for detecting port vulnerability


import PortScannerClass


targets_ip = input('Enter Target To Scan For Vulnerable Open Ports: ')
nr_of_ports = int(input('Enter Amount Of Ports You Want To Scan: '))
vul_file = input('Enter Path to File With Vulnerable Softwares: ')
print('\n')

target = PortScannerClass.PortScan(targets_ip, nr_of_ports)
target.scan()

with open(vul_file, 'r') as file:       # Open the .txt file
    count = 0
    for banner in target.banners:       # Compare found banners with vulnarable banners in the .txt file
        file.seek(0)
        for line in file.readlines():
            if line.strip() in banner:
                print('[!!] VULNERABLE BANNER: ' + banner + " ON PORT " + str(target.open_ports[count]))
        count += 1